<%- include('../partials/head') %>
<%- include('../partials/navbar') %>

<main class="page" data-aos="fade-up">
  <section class="section">
    <div class="section-inner">
      <h1 class="section-title">Testni tahrirlash</h1>

      <% if (typeof testError !== 'undefined' && testError) { %>
        <div class="alert alert-danger" style="margin-bottom:8px;font-size:13px;">
          <%= testError %>
        </div>
      <% } %>

      <% if (!test) { %>
        <p class="tests-empty">Test topilmadi yoki o'chirilgan.</p>
      <% } else { %>
        <form method="POST" action="/admin/tests/<%= test._id %>/edit" class="form-grid" style="max-width:520px;">
          <div class="form-group">
            <label for="test-title">Test nomi</label>
            <input type="text" id="test-title" name="title" value="<%= test.title %>" />
          </div>
          <div class="form-group">
            <label for="pdfLink">Test PDF (Google Drive) linki</label>
            <input type="url" id="pdfLink" name="pdfLink" value="<%= test.pdfLink %>" />
          </div>
          <div class="form-group">
            <label for="totalQuestions">Umumiy savollar soni</label>
            <input type="number" id="totalQuestions" name="totalQuestions" min="1" value="<%= typeof test.totalQuestions !== 'undefined' && test.totalQuestions !== null ? test.totalQuestions : '' %>" />
          </div>
          <div class="form-group">
            <label for="openCount">Ochiq savollar soni</label>
            <input type="number" id="openCount" name="openCount" min="0" value="<%= typeof test.openCount !== 'undefined' && test.openCount !== null ? test.openCount : 0 %>" />
            <small style="display:block;font-size:12px;color:#56756a;margin-top:4px;">Yopiq savollar soni avtomatik: umumiy - ochiq.</small>
          </div>
          <div class="form-group">
            <label for="answersText">Javoblar ro'yxati</label>
            <textarea id="answersText" name="answersText" rows="8"><%= test.answersText || '' %></textarea>
            <small style="display:block;font-size:12px;color:#56756a;margin-top:4px;">"N.javob" formatida: 1.A, 2.B, ..., 5.34</small>
          </div>
          <div class="form-group">
            <label for="videoLink">Video (Google Drive) linki (ixtiyoriy)</label>
            <input type="url" id="videoLink" name="videoLink" value="<%= test.videoLink || '' %>" />
          </div>
          <div style="display:flex;gap:8px;margin-top:8px;">
            <a href="/admin#admin-tests" class="btn-outline" style="flex:1;text-align:center;">Bekor qilish</a>
            <button type="submit" class="btn-primary" style="flex:1;">O'zgarishlarni saqlash</button>
          </div>
        </form>
      <% } %>
    </div>
  </section>
</main>

<%- include('../partials/footer') %>
